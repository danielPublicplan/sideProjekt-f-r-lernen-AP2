# yaml-language-server: $schema=../vendor/symfony/dependency-injection/Loader/schema/services.schema.json

parameters:

services:
  _defaults:
    autowire: true
    autoconfigure: true

  # Registriert alle Klassen in src/ als Services (Controller etc.)
  App\:
    resource: '../src/'
    exclude:
      - '../src/DependencyInjection/'
      - '../src/Kernel.php'

  # JWT Authenticator (Keycloak ODER Local)
  App\Security\MultiIssuerJwtAuthenticator:
    arguments:
      $keycloakIssuer: '%env(KEYCLOAK_ISSUER)%'
      $keycloakJwksUri: '%env(KEYCLOAK_JWKS_URI)%'
      $keycloakAzp: '%env(default::KEYCLOAK_AZP)%'
      $localIssuer: '%env(LOCAL_ISSUER)%'
      $localPublicKeyPath: '%env(resolve:LOCAL_PUBLIC_KEY)%'

  # Local JWT Issuer (f√ºr /auth/local/login)
  App\Security\LocalJwtIssuer:
    arguments:
      $issuer: '%env(LOCAL_ISSUER)%'
      $privateKeyPath: '%env(resolve:LOCAL_PRIVATE_KEY)%'
